webpackJsonp([1],{D8LU:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("xd7I"),s=n("e1F6"),a=n("zsLt"),r=n.n(a),o=n("kfHR"),c=n.n(o),u=(n("9r/T"),{name:"server",data:function(){return{twinkle:[]}},props:{status:{type:String,default:"success"}},computed:{getServerStatus:function(){var t=this.status;return"success"===t?"":"error"===t?"circle-twinkle-error":"warning"===t?"circle-twinkle-warning":""}},methods:{isTwinkle:function(t){return this.twinkle.includes(t)},randomTwinke:function(){var t=Math.ceil(10*Math.random()),e=c()(new r.a(Array(t).fill(0).map(function(t){return Math.ceil(12*Math.random())})));this.twinkle=e},statusTwinkle:function(){var t=this.status,e=this.$refs.circle.classList;"success"===t&&e.toggle("circle-twinkle"),"error"===t&&e.toggle("circle-twinkle-error"),"warning"===t&&e.toggle("circle-twinkle-warning")}},mounted:function(){},destroyed:function(){}}),l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"server"},[n("div",{ref:"circle",class:["circle",t.getServerStatus]}),t._v(" "),n("div",{staticClass:"dot-list"},t._l(18,function(e){return n("span",{key:e,class:{twinkle:t.isTwinkle(e)}})}),0)])},staticRenderFns:[]};var p={name:"server-group",components:{Server:n("C7Lr")(u,l,!1,function(t){n("sSJd")},"data-v-d2a3eda0",null).exports},props:{arrowDown:{type:Boolean,default:!1},spare:{type:Boolean},ip:{type:String},type:{type:String,default:""},name:{type:String,default:"服务器"},status:{type:String,default:"success"},notification:{type:Array,default:function(){return[]}},position:{type:Object,default:function(){return{left:0,top:0}}}},data:function(){return{loadingState:!0}},methods:{delayLoading:function(){var t=this;this.timer=window.setTimeout(function(){t.notification.length||(t.loadingState=!1)},5e3)},randomKey:function(){return Math.random()},transformClass:function(t){return 0===t?"normal":1===t?"warning":2===t?"danger":""}},computed:{id:function(){return this.keys?this.keys:this.name+"-"+this.ip}},destroyed:function(){window.clearTimeout(this.timer)},mounted:function(){"MQ"===this.type&&this.delayLoading()}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:"server-group server-group-"+t.status,style:{left:t.position.left+"px",top:t.position.top+"px"},attrs:{id:t.id,spare:t.spare}},[n("div",{class:["server-box","MQ"!==t.type?"server-box-status":"server-box-data","server-box-"+t.status]},[n("div",{staticClass:"server-name"},[t._v("\n      "+t._s(t.name)+"\n      "),t.ip?n("span",[t._v(t._s(t.ip))]):t._e()]),t._v(" "),"MQ"===t.type?n("div",{staticClass:"server-notification"},[t.notification.length?n("ul",t._l(t.notification,function(e){return n("li",{key:t.randomKey(e.value),class:t.transformClass(e.status)},[n("span",[t._v(t._s(e.name))]),t._v(":\n          "),n("span",[t._v(t._s(e.value))])])}),0):n("p",{class:["server-loading",t.loadingState?"el-icon-loading":""]},[t._v(t._s(t.loadingState?"":"暂无推送数据"))])]):t._e()]),t._v(" "),t.arrowDown?n("div",{staticClass:"server-arrow-down"}):t._e()])},staticRenderFns:[]};var f={name:"server-list",components:{ServerBox:n("C7Lr")(p,d,!1,function(t){n("cbIW")},"data-v-0af3ad17",null).exports},props:{serverData:{type:Array,default:function(){return[]}}},methods:{getFirstAndLastRect:function(){var t=this.$refs["server-group"].children,e=t.item(1),n=t.item(t.length-1),i=(e.offsetWidth+n.offsetWidth)/2,s=this.$refs["throughout-line"];s.style.setProperty("width","calc(100% - "+(i-1)+"px)"),s.style.setProperty("left",e.offsetWidth/2+"px")},getChildrenSize:function(){return this.serverData.length},drawLine:function(){var t=this,e=this.$refs.line;e&&e.forEach(function(e){var n=e.getBoundingClientRect(),i=e.parentElement.parentElement.getBoundingClientRect(),s=i.width/2+i.left,a=n.left;t.compareLineOfCenterDot(s,a,e)});var n=this.$refs.lineToParentSiblings;n&&n.forEach(function(e){var n=e.dataset.targetUp,i=e.getBoundingClientRect(),s=document.querySelector("#"+n).getBoundingClientRect(),a=s.width/2+s.left,r=i.left;t.compareLineOfCenterDot(a,r,e)})},compareLineOfCenterDot:function(t,e,n){var i=80,s=n.dataset.targetUp,a=void 0;s&&(a=document.querySelector("#"+s).getBoundingClientRect(),i=n.parentElement.querySelector(".server-group").getBoundingClientRect().top-a.bottom);var r=Math.abs(t-e),o=180*Math.atan2(i,r)/Math.PI,c=Math.sqrt(Math.pow(i,2)+Math.pow(r,2)),u=n.style;t-e>0&&(u.transform="rotate("+-o+"deg)"),t-e<0&&(u.transform="rotate("+-(180-o)+"deg)"),u.width=c+"px"}},mounted:function(){this.getChildrenSize()>=2&&this.getFirstAndLastRect()}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"server-group",staticClass:"server-rec"},[t.getChildrenSize()>=2?n("div",{ref:"throughout-line",staticClass:"throughout-line"}):t._e(),t._v(" "),t._l(t.serverData,function(e){return n("div",{key:e.id,staticClass:"server-rec-inner"},[e.hiddenLine?t._e():n("div",{ref:"line",refInFor:!0,staticClass:"line line-animate",style:{width:t.getChildrenSize()<2?"80px":"40px"}}),t._v(" "),t._l(e.targetParentSiblingsIds,function(t){return n("div",{key:t,ref:"lineToParentSiblings",refInFor:!0,staticClass:"line line-animate",attrs:{"data-target-up":t}})}),t._v(" "),n("ServerBox",{attrs:{"arrow-down":e.arrowDown,ip:e.ip,name:e.name,notification:e.notification,position:e.position,spare:e.isSpare,status:e.status,type:e.type}}),t._v(" "),e.list?n("server-list",{attrs:{"server-data":e.list}}):t._e()],2)})],2)},staticRenderFns:[]};var m=n("C7Lr")(f,v,!1,function(t){n("RrWL")},"data-v-8db24430",null).exports,h=(new s.a({mode:"history",routes:[{path:"/",name:"home",component:m}]}),n("jsbU")),g=n.n(h),S=n("ZLEe"),y=n.n(S),_={render:function(t,e){var n=t.metric;"192.168.200.159"===t.endpoint&&this.spare(t,e),/ORDER_NUMS/g.test(n)||/BUCKET_REQUEST_NUMS/g.test(n)||/BUCKET_USER_REQUEST_NUMS/g.test(n)||/ORDER_REQUEST_AVG_COST/g.test(n)||/DELAY_QUEUE_REQUEST_NUMS/g.test(n)?this.matchingAndSecurities(t,e):this[n]&&this[n](t,e)},spare:function(t,e){"status"===t.metric&&(e.isSpare=!0,delete e.type),"diff"===t.metric&&(e.isSpare=!1,e.type="MQ")},status:function(t,e){e.status="UP"===t.value.status?"success":"DOWN"===t.value.status?"error":""},matchingAndSecurities:function(t,e){var n=t.metric,i=e.notification||[],s=i.find(function(t){return t.key===n});s?s.value=t.value.num:i.push({key:t.metric,name:t.value.name,value:t.value.num})},diff:function(t,e){var n=t.value.groupNameReportList,i=y()(n);e.notification.length=0,i.forEach(function(t){e.notification.push({name:t,value:n[t].diffTotal})})}},w={mq:[{name:"RecoketMQ",ip:"192.168.112.116",type:"MQ",notification:[],onLineIp:"172.31.58.43",status:"success",list:[{name:"matching",ip:"192.168.200.120",type:"MQ",notification:[],onLineIp:"172.31.63.167",status:"success"},{name:"matching",ip:"192.168.200.116",type:"MQ",notification:[],onLineIp:"172.31.49.255",status:"success"},{name:"matching",ip:"192.168.200.13",type:"MQ",notification:[],onLineIp:"172.31.52.61",status:"success"},{name:"matching",ip:"192.168.200.121",type:"MQ",notification:[],onLineIp:"172.31.60.230",status:"success"}]},{name:"RecoketMQ",ip:"192.168.112.102",isSpare:!0,onLineIp:"172.31.63.144",status:"success",list:[{name:"matching",ip:"192.168.200.120",type:"MQ",notification:[],onLineIp:"172.31.63.167",status:"success"},{name:"matching",ip:"192.168.200.116",type:"MQ",notification:[],onLineIp:"172.31.49.255",status:"success"},{name:"matching",ip:"192.168.200.13",type:"MQ",notification:[],onLineIp:"172.31.52.61",status:"success"},{name:"matching",ip:"192.168.200.121",type:"MQ",notification:[],onLineIp:"172.31.60.230",status:"success"}]}],usdt:[{name:"EUREKA",ip:"192.168.200.114",onLineIp:"172.31.62.40",status:"success"},{name:"ZUUL",ip:"192.168.112.113",onLineIp:"172.31.49.234",status:"success",list:[{name:"WEBSERVICE",ip:"192.168.112.117",onLineIp:"172.31.52.245",status:"success",list:[{name:"SERVICE-SECURITIES2",ip:"192.168.200.122",onLineIp:"172.31.53.21",arrowDown:!0,status:"success"},{name:"SERVICE-SECURITIES3",ip:"192.168.200.151",onLineIp:"172.31.61.54",arrowDown:!0,status:"success"}]}]},{name:"ZUUL",ip:"192.168.112.114",onLineIp:"172.31.62.152",status:"success",list:[{name:"WEBSERVICE",ip:"192.168.112.118",onLineIp:"172.31.49.123",status:"success",list:[{name:"SERVICE-SECURITIES4",ip:"192.168.200.150",onLineIp:"172.31.53.115",arrowDown:!0,status:"success"}]}]},{name:"EUREKA",ip:"192.168.200.133",onLineIp:"172.31.63.69",status:"success"}]};!function t(e){e.forEach(function(e){e.ip=e.onLineIp,e.list&&t(e.list)})}(w.usdt),function t(e){e.forEach(function(e){e.ip=e.onLineIp,e.list&&t(e.list)})}(w.mq);var E=w,L={name:"home",components:{ServerList:m},data:function(){return{usdt:E.usdt,mq:E.mq}},methods:{rondomDotPos:function(){this.$refs.dotList.forEach(function(t){var e=t.style;e.left=100*Math.random()+"%",e.top=100*Math.random()+"%",e.opacity=Math.random(),e.backgroundColor="#"+Math.floor(256*Math.random()).toString(10)})},socketInit:function(){var t=this;var e=new WebSocket("ws://192.168.111.227:8083/websocket");e.onopen=function(){e.send('{"action":"0","metric":"","project":"USDT","serviceModule":""}')},e.onmessage=function(e){var n=JSON.parse(e.data);n.data&&(t.updateServerData(t.usdt,n.data),t.updateServerData(t.mq,n.data))},e.onclose=function(){console.log("连接已关闭...")}},updateServerData:function(t,e){var n=this;t.forEach(function(t){e.endpoint+e.serviceModule===t.ip+t.name&&_.render(e,t),t.list&&n.updateServerData(t.list,e)})}},mounted:function(){this.socketInit()},destroyed:function(){}},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page"},[e("div",{ref:"page-main",staticClass:"page-3d"},[this._m(0),this._v(" "),e("div",{staticClass:"server-page server-page-status"},[e("ServerList",{attrs:{"server-data":this.usdt}})],1),this._v(" "),e("div",{staticClass:"server-page server-page-mq"},[e("ServerList",{attrs:{"server-data":this.mq}})],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page-header"},[e("a",{attrs:{href:"https://www.58ex.com"}}),this._v(" "),e("s",[this._v("|")]),this._v(" "),e("h1",[this._v("58Coin服务器集群监控")])])}]};var I=n("C7Lr")(L,C,!1,function(t){n("zdgb")},null,null).exports;n("D8LU");i.default.use(g.a),new i.default({name:"App",render:function(t){return t(I)}}).$mount("#app")},RrWL:function(t,e){},cbIW:function(t,e){},sSJd:function(t,e){},zdgb:function(t,e){}},["NHnr"]);